<html>
  <head> </head>
  <body>
    <p>
      Diffie Hellman is a
      <span class="keyword">public key exchange</span> protocol. New
      <span class="keyword">Keys</span> are exchanged between the
      <span class="keyword">sender</span> and the
      <span class="keyword">receiver</span> before every
      <span class="keyword">session</span> and hence these keys are called
      <span class="keyword">ephemeral keys</span>. The
      <span class="keyword">key</span> that is generated by this protocol is a
      <span class="keyword">symmetric key</span> which means that the same key
      can be used for encryption and decryption.
    </p>
    <hr />
    <p>
      The algorithm: <br />
      Suppose <span class="keyword">P1</span> and
      <span class="keyword">P2</span> want to establish a secret
      <span class="keyword">shared key</span> between them, on an
      <span class="keyword">insecured channel</span>.
    </p>
    <ol>
      <li>
        They chose <span class="keyword">g</span> (prime number) and
        <span class="keyword">n</span> (very large number).
      </li>
      <li>
        <span class="keyword">P1</span> chooses a secret large number
        <span class="keyword">a</span> and
        <span class="keyword">P2</span> chooses a secret large number
        <span class="keyword">b</span>. <span class="keyword">a</span> and
        <span class="keyword">b</span> are not shared over the channel.
      </li>
      <li>
        <span class="keyword">P1</span> calculates
        <span class="keyword">r1</span> =
        <span class="keyword">(g^a mod n)</span> and
        <span class="keyword">P2</span> calculates
        <span class="keyword">r2</span> =
        <span class="keyword">(g^b mod n)</span>.
      </li>
      <li>
        <span class="keyword">r1</span> and <span class="keyword">r2</span> are
        shared between the two (<span class="keyword">public key exchange</span
        >). At this point, an attacker could know all numbers except
        <span class="keyword">a</span> and <span class="keyword">b</span> which
        are kept <span class="keyword">private</span> by
        <span class="keyword">P1</span> and <span class="keyword">P2</span>.
      </li>
      <li>
        <span class="keyword">P1</span> calculates
        <span class="keyword">k1</span> =
        <span class="keyword">(r2^a mod n)</span> and
        <span class="keyword">P2</span> calculates
        <span class="keyword">k2</span> =
        <span class="keyword">(r1^b mod n)</span>. Mathematically,
        <span class="keyword">k1</span> equals <span class="keyword">k2</span>.
        Hence a <span class="keyword">shared secret key</span> is established
        between <span class="keyword">P1</span> and
        <span class="keyword">P2</span> which can be used for encryption and
        decryption.
      </li>
    </ol>
  </body>
</html>
